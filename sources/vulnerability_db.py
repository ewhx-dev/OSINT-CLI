import asyncio
import random
from backend.core.models import VulnerabilityHit
from typing import List

async def collect_vulnerability_data(target: str) -> List[VulnerabilityHit]:
    """Simulates checking known public vulnerability databases (e.g., CVE, NVD)."""
    await asyncio.sleep(random.uniform(0.6, 1.0))
    
    if "company" in target.lower() or "server" in target.lower():
        return [
            VulnerabilityHit(
                source="NVD/CVE",
                cve_id="CVE-2024-4567",
                severity="CRITICAL",
                description="Known weakness in a simulated dependency (CVSS 9.8)."
            ),
            VulnerabilityHit(
                source="Shodan (Simulated)",
                severity="MEDIUM",
                description="Port 8080 exposed with an outdated server banner."
            )
        ]
    return []

async def collect_data(target: str):
    return await collect_vulnerability_data(target)